<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script src="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">




    <title>Document</title>
</head>
<body>
    




<div class="container">

    <div class="row">
        <div class="col-5 m-5">
            <div id="start"></div>

        </div>

        <div class="col-3 m-5">
            <div id="end"></div>

        </div>

    </div>
</div>

<div id="map"></div>




<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.min.js"></script>
<link
rel="stylesheet"
href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.css"
type="text/css"
/>



    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>


<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiZXJpa21hcjMiLCJhIjoiY2tjemo5bXF0MDQ5dDJ4bXRzNGI1dXNpZSJ9.ViWQU5_qEYs8pXNG5fQZKg';
    var start 
    var end 

    
    var geocoderStart = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken,
    placeholder: "Store Address",

    types: 'place,postcode,locality,neighborhood,address,poi'
    });
 
geocoderStart.addTo('#start');

var geocoderEnd = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken,
    placeholder: "Delivery Address",
    types: 'place,postcode,locality,neighborhood,address,poi'
    });
 
geocoderEnd.addTo('#end');



geocoderStart.on('result', function(e) {
    // map.getSource('single-point').setData(e.result.geometry);
    console.log(e.result.geometry.coordinates)

    var lon = e.result.geometry.coordinates[0]
    var lat = e.result.geometry.coordinates[1]

    start = lon +"," +  lat

    console.log(start)

  });

  geocoderEnd.on('result', function(e) {
    // map.getSource('single-point').setData(e.result.geometry);
    var lon = e.result.geometry.coordinates[0]
    var lat = e.result.geometry.coordinates[1]

    end =  lon +"," +  lat

    console.log( end)
    calculateDistance()

    return end

  });

//   calculateDistance()

function calculateDistance(){

    console.log()
    var queryURL = "https://api.mapbox.com/directions/v5/mapbox/driving/" + start + ";" + end +  "?geometries=geojson&access_token=pk.eyJ1IjoiZXJpa21hcjMiLCJhIjoiY2tjczBkdGwwMWsyczJ5bW9sOGM5ODhyNyJ9.pD90miDj9O02qnmcyUzO5Q"
    // var queryURL = "https://api.mapbox.com/directions/v5/mapbox/driving/-94.440454%2C39.226288%3B-94.267962%2C39.030479?alternatives=true&geometries=geojson&steps=true&access_token=pk.eyJ1IjoiZXJpa21hcjMiLCJhIjoiY2tjczBkdGwwMWsyczJ5bW9sOGM5ODhyNyJ9.pD90miDj9O02qnmcyUzO5Q"

    $.ajax({
        url: queryURL,
        method: "GET"
        }).then(function(response) {

            var miles = Math.ceil(response.routes[0].distance * 0.00062137)
            var minutes =Math.floor( (response.routes[0].duration/60))

            console.log(response)
            console.log(miles, minutes )

        })

}



</script>


</body>
</html>